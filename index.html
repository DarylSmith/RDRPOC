<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organization Selection Form</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="email"] {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        select[multiple] {
            width: 100%;
            height: 200px;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .error {
            color: red;
            margin-top: 5px;
            display: none;
        }
        .success {
            color: green;
            margin-top: 5px;
            display: none;
        }
        #organizationsGroup {
            display: none;
        }
        .info-message {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <form id="organizationForm">
        <div class="form-group">
            <label for="email">Email Address:</label>
            <input type="email" id="email" name="email" required>
            <div id="emailError" class="error">Please enter a valid email address</div>
        </div>
        <div class="info-message">
            This request will provide data on all registries. If you would like only specific registries, click on the "Select Specific Organizations" and choose the registries you would like.
        </div>
        
        <div class="form-group">
            <label>
                <input type="checkbox" id="selectOrganizations" name="selectOrganizations">
                Select Specific Registries
            </label>
        </div>

        <div class="form-group" id="organizationsGroup">
            <label for="organizations">Organizations (hold Ctrl/Cmd to select multiple):</label>
            <select id="organizations" name="organizations" multiple>
                <!-- Options will be populated by JavaScript -->
            </select>
        </div>

        <button type="submit">Submit</button>
        <div id="successMessage" class="success">Submission successful!</div>
        <div id="errorMessage" class="error">An error occurred. Please try again.</div>
    </form>

    <script>


        // Function to populate the organizations select
        function populateOrganizations() {
            const select = document.getElementById('organizations');
            
            // Sort organizations by name
            const sortedOrgs = organizationsData.sort((a, b) => a.name.localeCompare(b.name));
            
            // Create and append options
            sortedOrgs.forEach(org => {
                const option = document.createElement('option');
                option.value = org.id;
                option.textContent = org.name;
                select.appendChild(option);
            });
        }

        // Populate organizations on page load
        document.addEventListener('DOMContentLoaded', populateOrganizations);

        // Toggle organizations select visibility
        document.getElementById('selectOrganizations').addEventListener('change', function(e) {
            document.getElementById('organizationsGroup').style.display = 
                e.target.checked ? 'block' : 'none';
        });

        document.getElementById('organizationForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Reset messages
            document.getElementById('emailError').style.display = 'none';
            document.getElementById('successMessage').style.display = 'none';
            document.getElementById('errorMessage').style.display = 'none';
            
            // Get form values
            const email = document.getElementById('email').value;
            const organizationsSelect = document.getElementById('organizations');
            const selectedOrganizations = Array.from(organizationsSelect.selectedOptions)
                .map(option => option.value)
                .join(',');
            
            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                document.getElementById('emailError').style.display = 'block';
                return;
            }
            
            try {
                const response = await fetch('https://prod-24.canadacentral.logic.azure.com:443/workflows/3060f81275d24839adbf5770c95c8771/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=elWj1FbaexyCJb3CbYwG_yyLI1Z-4mkpG3LOCYwOuu4', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: email,
                        selectedOrganizations: selectedOrganizations
                    })
                });
                
                if (response.ok) {
                    document.getElementById('successMessage').style.display = 'block';
                    document.getElementById('organizationForm').reset();
                    document.getElementById('organizationsGroup').style.display = 'none';
                } else {
                    throw new Error('Network response was not ok');
                }
            } catch (error) {
                document.getElementById('errorMessage').style.display = 'block';
                console.error('Error:', error);
            }
        });

// organization data - this could be in a separate file
const organizationsData=
[{"id":"1","name":"Alpha-1 International Registry (AIR)"},
{"id":"2","name":"APS ACTION (Antiphospholipid Syndrome Alliance for Clinical Trials and International Networking) International Clinical Database and Repository"},
{"id":"3","name":"Autosomal Recessive Cerebellar Ataxia (ARCA) Global Registry"},
{"id":"4","name":"Autosomal Recessive Spastic Ataxia of Charlevoix-Saguenay (ARSACS) International Patient Registry"},
{"id":"5","name":"Barth Syndrome Registry and Repository (BRR)"},
{"id":"6","name":"Brain Vascular Malformation Consortium (BVMC)"},
{"id":"7","name":"Canadian Cholangiocarcinoma Collaborative (C3) Registry"},
{"id":"8","name":"CDKL5 International Patient Registry"},
{"id":"9","name":"Clinical Research Consortium for the Study of Cerebellar Ataxia (CRC-SCA)"},
{"id":"10","name":"Consortium for Clinical Investigation of Neurologic Channelopathies (CINCH)"},
{"id":"11","name":"CoRDS Ataxia Patient Registry"},
{"id":"12","name":"Diamond Blackfan Anemia Registry (DBAR)"},
{"id":"13","name":"EBCare Patient Insights Network (PIN)"},
{"id":"14","name":"Eosinophilic gastrointestinal disease (EGID) Partners"},
{"id":"15","name":"Enroll-HD"},
{"id":"16","name":"Fibrodysplasia Ossificans Progressiva (FOP) Registry"},
{"id":"17","name":"Frontotemporal Degeneration (FTD) Disorders Registry"},
{"id":"18","name":"FungiScope"},
{"id":"19","name":"Genetic Disorders of Mucociliary Clearance Consortium (GDMCC)"},
{"id":"20","name":"Genetic of Intellectual Disability and Autism Spectrum Disorders (GENiDA)"},
{"id":"21","name":"Global Angelman Syndrome Registry (GASR)"},
{"id":"22","name":"Global Dystonia Registry (GDR)"},
{"id":"23","name":"Global Mucopolysaccharidosis type I (MPS 1) Registry"},
{"id":"24","name":"Global Patient Registry for Smith-Kingsmore Syndrome (SKS)"},
{"id":"25","name":"Global Prader-Willi Syndrome (PWS) Registry"},
{"id":"26","name":"GNAO1 International Registry"},
{"id":"27","name":"Hyperinsulinism International Global Registry (HIGR)"},
{"id":"28","name":"International Diffuse intrinsic pontine glioma (DIPG)/diffuse midline glioma (DMG) Registry"},
{"id":"29","name":"International Fabry Registry"},
{"id":"30","name":"International Family Registry for Centronuclear and Myotubular Myopathies"},
{"id":"31","name":"International Fanconi Anemia Registry (IFAR)"},
{"id":"32","name":"International Fragile X Premutation Registry (IFXPR)"},
{"id":"33","name":"International Gaucher Registry"},
{"id":"34","name":"International GNE Myopathy Registry"},
{"id":"35","name":"International Hereditary Thrombotic Thrombocytopenic Purpura (hTTP) Registry"},
{"id":"36","name":"International Kawasaki Disease Registry (IKDR)"},
{"id":"37","name":"International LGDA Registry for Complex Lymphatic Anomalies"},
{"id":"38","name":"International Niemann-Pick Disease Registry (INPDR)"},
{"id":"39","name":"International Pachyonychia Congenita Research Registry (IPCRR)"},
{"id":"40","name":"International Pediatric Acute-Onset Neuropsychiatric syndrome (PANS) Registry"},
{"id":"41","name":"International Paroxysmal Nocturnal Hemoglobinuria (PNH) Registry"},
{"id":"42","name":"International Pyridoxine-dependent epilepsy (PDE) Registry"},
{"id":"43","name":"International Pompe Registry"},
{"id":"44","name":"International Registry For Pediatric Systemic Vasculitis (PedVas) Initiative"},
{"id":"45","name":"International Registry of Acute Aortic Dissection (IRAD)"},
{"id":"46","name":"International SCN8A Registry Research Study"},
{"id":"47","name":"International Study Group of Pediatric Pancreatitis: In search for a cure: INSPPIRE"},
{"id":"48","name":"Immune thrombocytoopenia (ITP) Natural History Study Registry"},
{"id":"49","name":"KIF1A Associated Neurologic Disorder (KAND) Natural History Study"},
{"id":"50","name":"Leber hereditary optic neuropathy (LHON) Data Collection Program"},
{"id":"51","name":"Life Raft Group Gastrointestinal stromal tumours (GIST) Patient Registry"},
{"id":"52","name":"MitoSHARE"},
{"id":"53","name":"Moebius Syndrome Foundation Contact Registry"},
{"id":"54","name":"Myotubular and Centronuclear Myopathies Patient Registry (MTM and CNM Registry)"},
{"id":"55","name":"The Nephrotic Syndrome Study Network: NEPTUNE"},
{"id":"56","name":"New-Onset Refractory Status Epilepticus (NORSE) Prospective Observational Study Registry"},
{"id":"57","name":"New-Onset Refractory Status Epilepticus (NORSE)/Febrile Infection-Related Epilepsy Syndrome (FIRES) Family Registry"},
{"id":"58","name":"North American Diamond Blackfan Anemia Registry (DBAR)"},
{"id":"59","name":"North American Malignant Hyperthermia Registry (NAMHR)"},
{"id":"60","name":"North American Mitochondrial Disease Consortium (NAMDC)"},
{"id":"61","name":"Primary Ciliary Dyskinesia Foundation Registry (PCDFR)"},
{"id":"62","name":"Pediatric Cardiomyopathy Registry (PCMR)"},
{"id":"63","name":"Paroxysmal nocturnal hemoglobinuria (PNH) Registry"},
{"id":"64","name":"Primary Immune Deficiency Treatment Consortium (PIDTC)"},
{"id":"65","name":"Primary sclerosing cholangitis (PSC) Partners Patient Registry"},
{"id":"66","name":"Rare Brain Tumor Consortium Global Registry"},
{"id":"67","name":"RARE-X CHD2 - Data Collection Program"},
{"id":"68","name":"Simons Searchlight"},
{"id":"69","name":"The Duchenne Registry"},
{"id":"70","name":"The International Registry and Natural History Study for Adaptor-Protein 4-related Hereditary Spastic Paraplegia"},
{"id":"71","name":"The International Replication Repair Deficiency Consortium (IRRDC)"},
{"id":"72","name":"The International Schwannomatosis Database"},
{"id":"73","name":"The North American Antiepileptic Drug (AED) Pregnancy Registry"},
{"id":"74","name":"The Progeria Research Foundation International Registry"},
{"id":"75","name":"Rare Diseases Clinical Research Network (RDCRN) Patient Contact Registry"},
{"id":"76","name":"The Scleroderma Patient-centred Intervention Network (SPIN) Cohort"},
{"id":"77","name":"The United States Immunodeficiency Network (USIDNET)"},
{"id":"78","name":"TREAT-NMD (Neuromuscular Diseases) Global Registry Network"},
{"id":"79","name":"Tuberous Sclerosis Complex Natural History Database and Biorepository (TSC Alliance)"},
{"id":"80","name":"Unique Families Global Network"},
{"id":"81","name":"Urea Cycle Disorders Consortium (UCDC)"},
{"id":"82","name":"Vasculitis Clinical Research Consortium (VCRC)"},
{"id":"83","name":"VISION Registry"},
{"id":"84","name":"Alberta Congenital Anomalies Surveillance System (ACASS)"},
{"id":"85","name":"Alpha-1 Canadian Registry"},
{"id":"86","name":"BC Glomerulonephritis (GN) Registry"},
{"id":"87","name":"Brain Tumour Registry of Canada (BTRC)"},
{"id":"88","name":"CAN-Fever Autoinflammatory Disease Registry"},
{"id":"89","name":"Canadian Acromegaly Registry"},
{"id":"90","name":"Canadian Apheresis Group (CAG) Thrombotic thrombocytopenic purpura (TTP) Registry"},
{"id":"91","name":"Canadian Atypical Teratoid Rhabdoid Tumors (ATRT) Registry"},
{"id":"92","name":"Canadian Biliary Atresia Registry (CBAR)"},
{"id":"93","name":"Canadian Bronchiectasis and Nontuberculous Mycobacteria (NTM) Database"},
{"id":"94","name":"Canadian Cancer Registry (CCR)"},
{"id":"95","name":"Canadian Cerebral Palsy Registry"},
{"id":"96","name":"Canadian Cystic Fibrosis Registry (CCFR)"},
{"id":"97","name":"Canadian Fabry Disease Initiative (CFDI)"},
{"id":"98","name":"Canadian Familial Hypercholesterolemia Registry"},
{"id":"99","name":"Toronto Glomerulonephritis Registry"},
{"id":"100","name":"Canadian Homozygous Familial Hypercholesterolemia (HoFH) Registry"},
{"id":"101","name":"Canadian Inflammatory Myopathy Study (CIMS)"},
{"id":"102","name":"Canadian Morphea Registry (C-MORE)"},
{"id":"103","name":"Canadian Myelodysplastic syndromes (MDS-CAN)"},
{"id":"104","name":"Canadian National Hypoparathyroidism Registry"},
{"id":"105","name":"Canadian Network for Autoimmune Liver Disease (CaNAL)"},
{"id":"106","name":"Canadian Neuromuscular Disease Registry (CNDR)"},
{"id":"107","name":"Canadian Paroxysmal Nocturnal Hemoglobinuria (PNH) Registry"},
{"id":"108","name":"Canadian Pediatric Neuroinflammatory Disorders Registry (CPND)"},
{"id":"109","name":"Canadian Prospective Cohort Study to Understand Progression in MS (CanProCo)"},
{"id":"110","name":"Canadian Pulmonary Hypertension Registry"},
{"id":"111","name":"Canadian Registry for Amyloidosis Research (CRAR)"},
{"id":"112","name":"Canadian Registry for Pulmonary Fibrosis (CARE-PF)"},
{"id":"113","name":"Canadian Rett Syndrome Registry"},
{"id":"114","name":"Canadian Sarcoma Research and Clinical Collaboration (CanSaRCC)"},
{"id":"115","name":"Canadian Scleroderma Research Group (CSRG)"},
{"id":"116","name":"Canadian Vasculitis Network (CanVasc) Registry"},
{"id":"117","name":"Cancer in Young People in Canada (CYP-C)"},
{"id":"118","name":"CAN-OPTICS: the Canadian Neuromyelitis Optica Spectrum Disorder and other atypical demyelinating diseases Cohort Study"},
{"id":"119","name":"Clinical Von Hippel-Lindau disease (VHL) Database"},
{"id":"120","name":"Discovering the Periodic Fever Syndrome Population at Hamilton Health Sciences"},
{"id":"121","name":"Fighting Blindness Canada (FBC) Inherited Retinal Disease Patient Registry"},
{"id":"122","name":"Genetic Studies of Chronic Kidney Disease"},
{"id":"123","name":"Genodermatoses Registry"},
{"id":"124","name":"KidCOM"},
{"id":"125","name":"Mastocytosis Assessment and Treatment Evaluation Registry"},
{"id":"126","name":"MitoCanada Patient Registry"},
{"id":"127","name":"Canadian Myeloma Research Group Database (CMRG-DB)"},
{"id":"128","name":"Myeloproliferative Neoplasms (MPNs) Patient Registry"},
{"id":"129","name":"National Hearts in Rhythm Organization (HiRO) Registry"},
{"id":"130","name":"Orphan Disease Center CDKL5 Deficiency Disorder International Patient Registry"},
{"id":"131","name":"Pediatric Neurofibromatosis Registry"},
{"id":"132","name":"Pediatric Oncology Group of ON Networked Information System (POGONIS)"},
{"id":"133","name":"Prospective Longitudinal Study to Assess Long-Term Safety of Treatments and the Epidemiology of Bleeding in Immune Thrombocytopenia"},
{"id":"134","name":"Province of Ontario Neurodevelopmental Disorders (POND) Network OBI: POND Registry"},
{"id":"135","name":"Quebec congenital heart disease registry"},
{"id":"136","name":"Quebec Myotonic Dystrophy Registry/ Registre québécois sur la dystrophie myotonique de type 1 Q-DMR"},
{"id":"137","name":"Quebec Trophoblastic Disease Network"},
{"id":"138","name":"Registry of Rare Diseases in Pregnancy (Groupe d'etude en medecine obstetricale du Québéc)"},
{"id":"139","name":"SickKids Lupus Registry"},
{"id":"140","name":"Southern Alberta Registry for Systemic Lupus Erythematosus (STARLET)"},
{"id":"141","name":"STXBP1.CA"},
{"id":"142","name":"The Canadian Alliance of Pediatric Rheumatology Investigators Juvenile Idiopathic (CAPRI) Registry"},
{"id":"143","name":"The Canadian Bleeding Disorders Registry (CBDR)"},
{"id":"144","name":"The Canadian Inherited Marrow Failure Registry (CIMFR)"},
{"id":"145","name":"The Canadian Inherited Metabolic Diseases Network (CIMDRN)"},
{"id":"146","name":"The Canadian Mucopolysaccharidosis (MPS) Registry"},
{"id":"147","name":"The University Health Network and SickKids Hospital Neurofibromatosis type 1 Registry"},
{"id":"148","name":"Toronto Hereditary Hemorrhagic Telangiectasia Database"},
{"id":"149","name":"Rare Kidney Stone Consortium (RKSC) Primary Hyperoxaluria Registry"}]

    </script>
</body>
</html>